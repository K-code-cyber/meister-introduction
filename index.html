<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚˜ë§Œì˜ D-Day ê³„ì‚°ê¸°</title>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }
        #dday-app {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 450px;
            width: 100%;
            text-align: center;
        }
        h2 {
            color: #333;
            margin-bottom: 25px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        .input-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        .input-container input, .input-container button {
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-size: 16px;
        }
        .input-container button {
            background-color: #007bff;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .input-container button:hover {
            background-color: #0056b3;
        }
        #dday-list {
            list-style: none;
            padding: 0;
        }
        #dday-list li {
            background-color: #e9ecef;
            margin-bottom: 10px;
            padding: 15px;
            border-radius: 8px;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s;
        }
        #dday-list li:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .dday-result {
            font-weight: bold;
            color: #007bff;
        }
        .dday-text-finish {
            color: #dc3545;
            font-size: 20px;
        }
        .delete-btn {
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
        }
        .delete-btn:hover {
            color: #dc3545;
        }
    </style>
</head>
<body>

    <div id="dday-app">
        <h2>ë‚˜ë§Œì˜ D-Day ê³„ì‚°ê¸° ğŸ“…</h2>
        <div class="input-container">
            <input type="text" id="event-name" placeholder="ì´ë²¤íŠ¸ ì´ë¦„ (ì˜ˆ: ì‹œí—˜, ì—¬í–‰)">
            <input type="date" id="target-date">
            <button id="add-button">D-Day ì¶”ê°€í•˜ê¸°</button>
        </div>
        
        <ul id="dday-list">
        </ul>
    </div>

    <script>
        // --- í•µì‹¬ ë¡œì§: D-Day ê³„ì‚° ë° í¬ë§· ---
        function calculateAndFormatDDay(targetDateStr) {
            const targetDate = new Date(targetDateStr);
            const today = new Date();
            
            today.setHours(0, 0, 0, 0); 
            targetDate.setHours(0, 0, 0, 0);

            const timeDifference = targetDate.getTime() - today.getTime();
            const oneDay = 1000 * 60 * 60 * 24; 
            const daysDifference = Math.ceil(timeDifference / oneDay);

            if (daysDifference > 0) {
                return { text: `D-${daysDifference}`, isToday: false };
            } else if (daysDifference === 0) {
                return { text: `D-DAY ğŸ‰`, isToday: true };
            } else {
                return { text: `D+${Math.abs(daysDifference)}`, isToday: false };
            }
        }

        // --- í™”ë©´ í‘œì‹œ ë° DOM ì¡°ì‘ ---
        function renderDDayList() {
            const listContainer = document.getElementById('dday-list');
            listContainer.innerHTML = ''; // ëª©ë¡ì„ ë¹„ìš°ê³  ë‹¤ì‹œ ê·¸ë¦½ë‹ˆë‹¤.
            
            const savedList = JSON.parse(localStorage.getItem('ddayList') || '[]');
            
            savedList.forEach((item, index) => {
                const { text, isToday } = calculateAndFormatDDay(item.date);
                
                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <span>${item.name} (${item.date})</span>
                    <div>
                        <span class="dday-result ${isToday ? 'dday-text-finish' : ''}">${text}</span>
                        <button class="delete-btn" data-index="${index}">ì‚­ì œ</button>
                    </div>
                `;
                listContainer.appendChild(listItem);
            });
        }

        // --- LocalStorage (ì €ì¥ ë° ì‚­ì œ ê¸°ëŠ¥) ---
        function saveDDay(newDDay) {
            let list = JSON.parse(localStorage.getItem('ddayList') || '[]');
            
            // ì¤‘ë³µ í™•ì¸ì€ ìƒëµí•˜ê³  ìƒˆ í•­ëª©ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
            list.push(newDDay);
            localStorage.setItem('ddayList', JSON.stringify(list));
            renderDDayList();
        }

        function deleteDDay(index) {
            let list = JSON.parse(localStorage.getItem('ddayList') || '[]');
            list.splice(index, 1); // í•´ë‹¹ ì¸ë±ìŠ¤ì˜ í•­ëª© ì‚­ì œ
            localStorage.setItem('ddayList', JSON.stringify(list));
            renderDDayList(); // ëª©ë¡ ë‹¤ì‹œ ë Œë”ë§
        }
        
        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • (ë²„íŠ¼ í´ë¦­) ---
        document.addEventListener('DOMContentLoaded', function() {
            // 1. í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ì¡´ ëª©ë¡ì„ í™”ë©´ì— í‘œì‹œ
            renderDDayList(); 

            // 2. ì¶”ê°€ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            document.getElementById('add-button').addEventListener('click', function() {
                const eventName = document.getElementById('event-name').value.trim();
                const targetDateStr = document.getElementById('target-date').value;

                if (!eventName || !targetDateStr) {
                    alert("ì´ë²¤íŠ¸ ì´ë¦„ê³¼ ë‚ ì§œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    return;
                }
                
                const newDDay = { name: eventName, date: targetDateStr };
                saveDDay(newDDay); // ì €ì¥ ë° í™”ë©´ ì—…ë°ì´íŠ¸
                
                // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                document.getElementById('event-name').value = '';
                document.getElementById('target-date').value = '';
            });

            // 3. ì‚­ì œ ë²„íŠ¼ ìœ„ì„ ì´ë²¤íŠ¸ (ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ë²„íŠ¼ ì²˜ë¦¬ë¥¼ ìœ„í•´)
            document.getElementById('dday-list').addEventListener('click', function(e) {
                if (e.target.classList.contains('delete-btn')) {
                    const index = parseInt(e.target.dataset.index);
                    deleteDDay(index);
                }
            });
        });
        
    </script>
</body>
</html>
